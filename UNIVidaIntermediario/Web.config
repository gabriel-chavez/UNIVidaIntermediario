<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="log4net"
             type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
  </configSections>
  <appSettings>
    <add key="TraOriCanal" value="34" />
    <add key="TipoTramite" value="5" />

    <add key="RecaptchaSiteKey" value="6LeU2q4gAAAAABzvAmgz3M1BoS09yYq3juD_etN-" />
    <add key="RecaptchaSecretKey" value="6LeU2q4gAAAAANvIoZuIZEX9iMJ4k6KFWPWu-RFX" />
    <add key="EnableRecaptcha" value="false" />
    <!--<add key="SoatApiBaseUrl" value="https://app-desarrollo.univida.bo:8009" />-->
    <add key="SoatApiBaseUrl" value="https://app-calidad.univida.bo:7009" />
  </appSettings>
  <system.webServer>
    <httpProtocol>
      <customHeaders>
        <!-- Eliminar headers -->
        <remove name="X-Powered-By" />
        <remove name="X-AspNet-Version" />
        <remove name="X-AspNetMvc-Version" />
        <remove name="Server" />

        <!-- headers de seguridad -->
        <add name="X-Content-Type-Options" value="nosniff" />
        <add name="X-Frame-Options" value="SAMEORIGIN" />
        <add name="X-XSS-Protection" value="1; mode=block" />
        <add name="Referrer-Policy" value="strict-origin-when-cross-origin" />
        <add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains" />
        <!-- Content Security Policy (CSP) -->
        <add name="Content-Security-Policy"
         value="default-src 'self';
                script-src 'self' 'unsafe-inline' 'unsafe-eval' 
                         https://www.google.com 
                         https://www.gstatic.com 
                         https://cdn.jsdelivr.net 
                         https://cdn.lordicon.com 
                         https://ajax.aspnetcdn.com
                         https://cdnjs.cloudflare.com
                         https://stackpath.bootstrapcdn.com
                         https://code.jquery.com;
                style-src 'self' 'unsafe-inline' 
                         https://fonts.googleapis.com 
                         https://cdnjs.cloudflare.com 
                         https://cdn.jsdelivr.net 
                         https://ajax.aspnetcdn.com
                         https://stackpath.bootstrapcdn.com
                         https://cdnjs.cloudflare.com;
                img-src 'self' data: blob: https:;
                font-src 'self' data: 
                         https://fonts.gstatic.com 
                         https://cdnjs.cloudflare.com 
                         https://cdn.jsdelivr.net 
                         https://ajax.aspnetcdn.com
                         https://stackpath.bootstrapcdn.com;
                connect-src 'self' 
                         https://app-calidad.univida.bo:7009 
                         https://www.google.com
                         https://cdn.lordicon.com
                         wss:;                
                frame-src 'self' 
                     data:
                     blob:
                     https://www.google.com 
                     https://recaptcha.google.com;
            frame-ancestors 'none';
            form-action 'self';
            base-uri 'self';
            object-src 'none';" />


        <!-- C. PERMISSIONS POLICY (Feature-Policy) -->
        <add name="Permissions-Policy"
             value="geolocation=(), 
                    camera=(), 
                    microphone=(), 
                    payment=(), 
                    usb=(), 
                    serial=(), 
                    magnetometer=(), 
                    gyroscope=(), 
                    accelerometer=()" />

        <!-- D. EXPECT-CT (Certificate Transparency) -->
        <add name="Expect-CT"
             value="max-age=86400, enforce, report-uri='https://calidad.univida.bo/report-ct'" />


      </customHeaders>
    </httpProtocol>
    <rewrite>
      <outboundRules>
        <!-- Eliminar Server header -->
        <rule name="Remove X-SourceFiles Header">
          <match serverVariable="RESPONSE_X_SourceFiles" pattern=".*" />
          <action type="Rewrite" value="" />
        </rule>
        <rule name="Remove Server header">
          <match serverVariable="RESPONSE_SERVER" pattern=".*" />
          <action type="Rewrite" value="" />
        </rule>

        <!-- Eliminar X-Powered-By header -->
        <rule name="Remove X-Powered-By header">
          <match serverVariable="RESPONSE_X_Powered_By" pattern=".*" />
          <action type="Rewrite" value="" />
        </rule>

        <!-- Eliminar X-AspNet-Version header -->
        <rule name="Remove X-AspNet-Version header">
          <match serverVariable="RESPONSE_X_AspNet_Version" pattern=".*" />
          <action type="Rewrite" value="" />
        </rule>
      </outboundRules>
      <rules>
        <rule name="Add ASPX extension" stopProcessing="true">
          <match url="^(.*)$" />
          <conditions>
            <!-- Si no existe como archivo -->
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
            <!-- Si no existe como directorio -->
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
            <!-- Si no termina en .aspx -->
            <add input="{REQUEST_FILENAME}" pattern="\.aspx$" negate="true" />
            <!-- Si es una de las páginas que queremos mapear -->
            <add input="{REQUEST_URI}" pattern="^/(venta|login|otrapagina|NotFound|ServerError|Error)" />
          </conditions>
          <action type="Rewrite" url="{R:1}.aspx" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
  <system.web>
    <customErrors mode="Off" defaultRedirect="~/ServerError.aspx">
      <error statusCode="404" redirect="~/NotFound.aspx" />
      <error statusCode="500" redirect="~/ServerError.aspx" />
    </customErrors>
    <sessionState mode="InProc" cookieless="false" timeout="20" />

    <compilation debug="true" targetFramework="4.6.2" />
    <httpRuntime targetFramework="4.6.2" enableVersionHeader="false" requestValidationMode="2.0" maxRequestLength="10240" executionTimeout="3600" />
    <authentication mode="Forms">
      <forms loginUrl="~/Login" defaultUrl="~/venta" timeout="4320" slidingExpiration="true" protection="All" requireSSL="false" cookieless="UseCookies" />
    </authentication>
    <httpCookies httpOnlyCookies="true" requireSSL="false" />
    <authorization>
      <deny users="?" />
    </authorization>
    <pages enableViewStateMac="true" enableEventValidation="true" viewStateEncryptionMode="Auto" controlRenderingCompatibilityVersion="4.0">

      <namespaces>
        <add namespace="System.Web.Optimization" />
      </namespaces>
      <controls>
        <add assembly="Microsoft.AspNet.Web.Optimization.WebForms" namespace="Microsoft.AspNet.Web.Optimization.WebForms" tagPrefix="webopt" />

        <add tagPrefix="ajaxToolkit" assembly="AjaxControlToolkit" namespace="AjaxControlToolkit" />
      </controls>
    </pages>

  </system.web>
  <location path="Login.aspx">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
  <location path="Content">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Antlr3.Runtime" publicKeyToken="eb42632606e9261f" />
        <bindingRedirect oldVersion="0.0.0.0-3.5.0.2" newVersion="3.5.0.2" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Web.Infrastructure" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" />
        <bindingRedirect oldVersion="0.0.0.0-13.0.0.0" newVersion="13.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:1659;1699;1701" />
      <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=\&quot;Web\&quot; /optionInfer+" />
    </compilers>
  </system.codedom>
  <system.serviceModel>
    <bindings />
    <client />
  </system.serviceModel>
  <log4net>
    <appender name="DailyRollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <!-- Carpeta donde se guardan los logs -->
      <file value="D:\IIS_Log4Net\UNIVidaVentaRural\logInternos_" />
      <!-- Ruta por fecha -->
      <rollingStyle value="Date" />
      <datePattern value="yyyy-MM-dd'.log'" />
      <staticLogFileName value="false" />
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <layout type="log4net.Layout.PatternLayout">
        <!-- Formato: [2025-08-29 18:20:45] INFO  NombreClase - Mensaje -->
        <conversionPattern value="[%date{yyyy-MM-dd HH:mm:ss}] %-5level %logger - %message%newline%exception" />
      </layout>
    </appender>
    <!-- Nivel de log: DEBUG, INFO, WARN, ERROR, FATAL, ALL -->
    <root>
      <level value="DEBUG" />
      <appender-ref ref="DailyRollingFileAppender" />
    </root>
  </log4net>
</configuration>